#version 1 generated by gemini
- name: Install and Configure Glances
  hosts: all  # Adjust to your target hosts
  become: true
  tasks:
    - name: Download and Install Glances
      shell: curl -L https://bit.ly/glances | /bin/bash
      register: glances_install_result
      changed_when: "'Installation successful' in glances_install_result.stdout"

    - name: Wait for Glances Installation to Complete
      pause:
        minutes: 2

    - name: Start Glances with Web Interface and Authentication
      command: glances -w --username your_username --password your_password
      async: 3600  # Run in background for up to 1 hour
      poll: 0
      register: glances_start_result
      ignore_errors: true # so that ansible doesn't fail if glances is already running

    - name: Check Glances start result.
      debug:
        var: glances_start_result
      when: glances_start_result.rc != 0

  vars:
    your_username: "glances" 
    your_password: "glances" 
