# ==============================================================================
# Filename:       roles/backup_manager/tasks/proxmox.yml
# Version:        1.0
# Author:         Gemini CLI
# Last Modified:  2026-02-02
# Context:        http://trac.home.arpa/ticket/3008
#
# Purpose:
#    Templates and manages /etc/pve/jobs.cfg for Proxmox backup scheduling.
# ==============================================================================
---
- name: "Ensure /etc/pve/jobs.cfg is managed"
  template:
    src: jobs.cfg.j2
    dest: /etc/pve/jobs.cfg
    owner: root
    group: www-data
    mode: '0640'
  notify: reload pve-cluster
  when: proxmox_backup_jobs is defined